<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Using Repositories with Laravel | ollieread.com</title>

    <link rel="home" href="https://ollieread.com">
    <link rel="icon" href="/favicon.ico">
    <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="ollieread.com Atom Feed">

    <link rel="stylesheet" href="/assets/build/css/app.css?id=9d2bb2ccf5ec74454d4e6db68f8d60df">

    
        <!--  Metadata -->
    <meta name="description" content="" />

    <!-- OpenGraph Metadata -->
    <meta name="og:type" property="og:type" content="article" />
    <meta name="og:title" property="og:title" content="Using Repositories with Laravel"/>
    <meta name="og:url" property="og:url" content="https://ollieread.com/archive/read/using-repositories-with-laravel" />
    <meta name="og:locale" property="og:locale" content="en_GB" />
    <meta name="og:site_name" property="og:site_name" content="ollieread.com"/>
    <meta name="og:image" property="og:image" content="/assets/images/page-thumbnail.png" />

    <!-- Article Metadata -->
    <meta name="article:published_time" property="article:published_time" content="2018-04-06T20:34:49+00:00"/>
    <meta name="article:section" property="article:section" content="tutorials"/>

    <!-- Twitter Metadata -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@ollieread" />
</head>

<body class="antialiased">

<header class="header">

    <nav class="header__links">
    <a href="https://twitter.com/ollieread" target="__blank" class="header__link header__link--twitter">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="100%" height="100%">
            <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/>
        </svg>
    </a>
    <a href="https://phpc.social/@ollieread" target="__blank" class="header__link header__link--mastodon" rel="me">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="100%" height="100%">
            <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
            <path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/>
        </svg>
    </a>
    <a href="https://github.com/ollieread" target="__blank" class="header__link header__link--github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" width="100%" height="100%">
            <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
            <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>
        </svg>
    </a>
    <a href="https://youtube.com/@olliecodes" target="__blank" class="header__link header__link--youtube">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="100%" height="100%">
            <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
            <path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/>
        </svg>
    </a>
    <a href="https://discord.gg/rtQF6jCTk3" target="__blank" class="header__link header__link--discord">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" width="100%" height="100%">
            <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
            <path d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"/>
        </svg>
    </a>
</nav>    <img src="/assets/images/ollieread.jpg"
         alt="Picture of ollieread"
         class="header__image">

    <div class="header__title">Ollie Read</div>

    <div class="header__nav navbar">
    <a href="/" class="navbar__item ">
        <svg class="navbar__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M272.5 5.7C281.4-1.9 294.6-1.9 303.5 5.7L567.5 229.7C577.6 238.3 578.9 253.4 570.3 263.5C561.7 273.6 546.6 274.9 536.5 266.3L512 245.5V432C512 476.2 476.2 512 432 512H144C99.82 512 64 476.2 64 432V245.5L39.53 266.3C29.42 274.9 14.28 273.6 5.7 263.5C-2.876 253.4-1.634 238.3 8.473 229.7L272.5 5.7zM112 204.8V432C112 449.7 126.3 464 144 464H432C449.7 464 464 449.7 464 432V204.8L288 55.47L112 204.8z"/></svg>
        <svg class="navbar__icon navbar__icon--full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c.2 35.5-28.5 64.3-64 64.3H128.1c-35.3 0-64-28.7-64-64V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>
        Home
    </a>
    <a href="/articles" class="navbar__item ">
        <svg class="navbar__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M456 32h-304C121.1 32 96 57.13 96 88v320c0 13.22-10.77 24-24 24S48 421.2 48 408V112c0-13.25-10.75-24-24-24S0 98.75 0 112v296C0 447.7 32.3 480 72 480h352c48.53 0 88-39.47 88-88v-304C512 57.13 486.9 32 456 32zM464 392c0 22.06-17.94 40-40 40H139.9C142.5 424.5 144 416.4 144 408v-320c0-4.406 3.594-8 8-8h304c4.406 0 8 3.594 8 8V392zM264 272h-64C186.8 272 176 282.8 176 296S186.8 320 200 320h64C277.3 320 288 309.3 288 296S277.3 272 264 272zM408 272h-64C330.8 272 320 282.8 320 296S330.8 320 344 320h64c13.25 0 24-10.75 24-24S421.3 272 408 272zM264 352h-64c-13.25 0-24 10.75-24 24s10.75 24 24 24h64c13.25 0 24-10.75 24-24S277.3 352 264 352zM408 352h-64C330.8 352 320 362.8 320 376s10.75 24 24 24h64c13.25 0 24-10.75 24-24S421.3 352 408 352zM400 112h-192c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h192c17.67 0 32-14.33 32-32v-64C432 126.3 417.7 112 400 112z"/></svg>
        <svg class="navbar__icon navbar__icon--full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M96 96c0-35.3 28.7-64 64-64H448c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H80c-44.2 0-80-35.8-80-80V128c0-17.7 14.3-32 32-32s32 14.3 32 32V400c0 8.8 7.2 16 16 16s16-7.2 16-16V96zm64 24v80c0 13.3 10.7 24 24 24H424c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24H184c-13.3 0-24 10.7-24 24zm0 184c0 8.8 7.2 16 16 16h96c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16zm160 0c0 8.8 7.2 16 16 16h96c8.8 0 16-7.2 16-16s-7.2-16-16-16H336c-8.8 0-16 7.2-16 16zM160 400c0 8.8 7.2 16 16 16h96c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16zm160 0c0 8.8 7.2 16 16 16h96c8.8 0 16-7.2 16-16s-7.2-16-16-16H336c-8.8 0-16 7.2-16 16z"/></svg>
        Articles
    </a>
    <a href="/archive" class="navbar__item ">
        <svg class="navbar__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M464 32h-416C21.49 32 0 53.49 0 80v64C0 161.6 14.4 176 31.1 176L32 416c0 35.35 28.65 64 64 64h320c35.35 0 64-28.65 64-64V176c17.6 0 32-14.4 32-31.1V80C512 53.49 490.5 32 464 32zM416 432H96c-8.837 0-16-7.163-16-16V176h352V416C432 424.8 424.8 432 416 432zM464 128h-416V80h416V128zM183.1 272h144C341.3 272 352 261.3 352 248C352 234.7 341.3 224 328 224H183.1C170.7 224 160 234.7 160 247.1C160 261.3 170.7 272 183.1 272z"/></svg>
        <svg class="navbar__icon navbar__icon--full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M32 32H480c17.7 0 32 14.3 32 32V96c0 17.7-14.3 32-32 32H32C14.3 128 0 113.7 0 96V64C0 46.3 14.3 32 32 32zm0 128H480V416c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V160zm128 80c0 8.8 7.2 16 16 16H336c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16z"/></svg>
        Archive
    </a>
    
</div>
</header>

<main class="section content">
    
    
    <div class="panel">
    
    <header class="panel__header">

        <div class="panel__badges">
            <a href="/"
               class="badge badge--green">Category</a>
                            <span class="badge badge--red">Archived</span>
                    </div>

        <h1 class="panel__header-title">Using Repositories with Laravel</h1>

        <time class="panel__header-time">6th April, 2018</time>

    </header>
    <main class="panel__body">
        <p>The repository pattern is one that appears to polarize developers, with half swearing by and half swearing against. It's also something that seems to have been spoken about a lot, though I feel that more often than not, it's an over complicated over engineered approach.</p>
<p>I've spent a good amount of time working with repositories, and these days, it's rare that my projects don't have them. I've also encountered a lot of projects, written by others, with repositories straight out of a tutorial, that is to say, full of interfaces.</p>
<h3><a id="what-is-the-repository-pattern" href="#what-is-the-repository-pattern" class="hidden" aria-hidden="true" title="Permalink"></a>What is the repository pattern?</h3>
<p>To quote <em>Patterns of Enterprise Application Architecture</em>;</p>
<blockquote>
<p>Mediates between the domain and data mapping layers using a collection-like interface for accessing domain objects.</p>
</blockquote>
<p>Simply put, a repository is an abstraction of the interaction with a data source, and/or the persistence layer. The idea is that your database interactions are sufficiently abstracted as to be easily modified and swapped out with little to no overhead.</p>
<p>The approach itself is amazingly useful, for applications of all sizes.</p>
<h3><a id="why-should-i-use-a-repository" href="#why-should-i-use-a-repository" class="hidden" aria-hidden="true" title="Permalink"></a>Why should I use a repository?</h3>
<p>Simply put, because you want your code to be more manageable. Sure you can add lots of methods to your models, but if you've ever looked at the full structure of a model, they're already pretty full.</p>
<h3><a id="the-interface-approach" href="#the-interface-approach" class="hidden" aria-hidden="true" title="Permalink"></a>The interface approach</h3>
<p>A lot of tutorials will approach repositories in Laravel by having you create an interface per repository, and then binding your concrete instance to the interface, using Laravels IoC container.</p>
<p>The goal with this approach, is that you've defined the API of your repository, and should you need to change data source in the future, you can quite easily create a new repository and implement your interface. This is all good and well in principal, but it'll end up filling your application with interfaces, and somewhat over complicating the process.</p>
<p>The chances of you changing your data source at a later date are pretty low. On top of that, most modern IDEs will let you very easily extract an interface from a repository, so you can create one when you need one. Further more, even with the best planning in the world, your repositories will not be the same at the end of the project, as they were at the start. This means that you're constantly having to update the interfaces, as well as the repositories themselves.</p>
<h3><a id="a-simpler-approach" href="#a-simpler-approach" class="hidden" aria-hidden="true" title="Permalink"></a>A simpler approach</h3>
<p>The most common reason for not using repositories, is that it's a lot of extra effort, for no real benefit. The answer to that, is to simplify the approach.</p>
<p>I have a package that I use in almost all Laravel projects, I called it <a rel="noopener noreferrer" target="_blank" class="link link--external" href="https://packagist.org/packages/ollieread/laravel-toolkit">my toolkit</a>. Amongst other things, it contains a base repository that I use for everything that uses Eloquent. It's relatively simple, and the source can be <a rel="noopener noreferrer" target="_blank" class="link link--external" href="https://github.com/ollieread/toolkit/blob/master/src/Repositories/BaseRepository.php">viewed here</a>.</p>
<p>When I start a new project, I can create a fully functional repository that works for most cases by simply extending my base repository like so;</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #6A737D;">/**</span></div><div class='line'><span style="color: #6A737D;"> * &#64;method Post make()</span></div><div class='line'><span style="color: #6A737D;"> * &#64;method null|Post getOneById(int $id)</span></div><div class='line'><span style="color: #6A737D;"> */</span></div><div class='line'><span style="color: #F97583;">class</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">PostRepository</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">extends</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">BaseRepository</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">protected</span><span style="color: #E1E4E8;"> $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">Post</span><span style="color: #F97583;">::class</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>The above, is a legitimate repository, lifted directly from a working codebase. Because of the helper methods (you'll see them later on in this post), I'm able to perform almost all of the actions I need, using the generic approaches. Should I require a specific method that does something different, I can define it here.</p>
<p>You'll also notice that I redefined some of the methods from the base repository, using the php docblocks. The reason for this is so that my IDE knows the exact instance expected.</p>
<p>Lets break down this base repository.</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">abstract</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">class</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">BaseRepository</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #6A737D;">/**</span></div><div class='line'><span style="color: #6A737D;">     * &#64;var string</span></div><div class='line'><span style="color: #6A737D;">     */</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">protected</span><span style="color: #E1E4E8;"> $model;</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #6A737D;">/**</span></div><div class='line'><span style="color: #6A737D;">     * &#64;return Model</span></div><div class='line'><span style="color: #6A737D;">     */</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">protected</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">make</span><span style="color: #E1E4E8;">()</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">Model</span></div><div class='line'><span style="color: #E1E4E8;">    {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">new</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #E1E4E8;">model;</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #6A737D;">/**</span></div><div class='line'><span style="color: #6A737D;">     * &#64;return \Illuminate\Database\Eloquent\Builder</span></div><div class='line'><span style="color: #6A737D;">     */</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">protected</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">query</span><span style="color: #E1E4E8;">()</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">Builder</span></div><div class='line'><span style="color: #E1E4E8;">    {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">make</span><span style="color: #E1E4E8;">()</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">newQuery</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>You'll notice that the class is <code>abstract</code> so that it must be extended, and the child classes should redefine the <code>$model</code> property with the class name of the model in question.</p>
<p>Next you'll see two methods, <code>make()</code> and <code>query()</code>. If not by their names, the body of these methods provides a sufficient explanation as to what they do.</p>
<p>Realistically, this is all that you need for a repository, and anything on top of this would just be nice helper methods. An example implementation of this would be as follows;</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">class</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">PostRepository</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">extends</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">BaseRepository</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">protected</span><span style="color: #E1E4E8;"> $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">Post</span><span style="color: #F97583;">::class</span><span style="color: #E1E4E8;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">public</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">getPaginated</span><span style="color: #E1E4E8;">(</span><span style="color: #F97583;">int</span><span style="color: #E1E4E8;"> $count </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">20</span><span style="color: #E1E4E8;">)</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">LengthAwarePaginator</span></div><div class='line'><span style="color: #E1E4E8;">    {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">query</span><span style="color: #E1E4E8;">()</span></div><div class='line'><span style="color: #E1E4E8;">            </span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">orderBy</span><span style="color: #E1E4E8;">(</span><span style="color: #9ECBFF;">&#39;created_at&#39;</span><span style="color: #E1E4E8;">, </span><span style="color: #9ECBFF;">&#39;desc&#39;</span><span style="color: #E1E4E8;">)</span></div><div class='line'><span style="color: #E1E4E8;">            </span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">paginate</span><span style="color: #E1E4E8;">($count);</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>The class itself provides a nice method for creating a new instance of the model in question, as well as query builder instance for it. Some may argue that the <code>query()</code> method isn't needed, as technically the Model will pass it through, but I'm a fan of IDEs being able to detect what's happening. Magic is all good and well in small doses, but I prefer to be aware of exactly what's going on.</p>
<p>If you've taken a look at the source of my repository, you'll also notice a few other methods in there. These methods are purely to simplify my life, and implementing things like this, could aid you too.</p>
<p>The first method we have is the <code>getId()</code> method.</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">protected</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">getId</span><span style="color: #E1E4E8;">($model)</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">int</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> $model </span><span style="color: #F97583;">instanceof</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">Model</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">?</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">getKey</span><span style="color: #E1E4E8;">() </span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> $model;</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>Sometimes, you may want to pass in either the full model, or just the id. There are plenty of reasons for wanting to do this, which is why this method was born. It's essentially a normalisation method, that will return the key (within reason). The assumption is that the value is either a model, or the id/key. I can be certain this is the case, because of how the code is accessed.</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">public</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">persist</span><span style="color: #E1E4E8;">(</span><span style="color: #F97583;">array</span><span style="color: #E1E4E8;"> $input, $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">null</span><span style="color: #E1E4E8;">)</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> ($model) {</span></div><div class='line'><span style="color: #E1E4E8;">        $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">getOneById</span><span style="color: #E1E4E8;">($model);</span></div><div class='line'><span style="color: #E1E4E8;">    } </span><span style="color: #F97583;">else</span><span style="color: #E1E4E8;"> {</span></div><div class='line'><span style="color: #E1E4E8;">        $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">make</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> ($model </span><span style="color: #F97583;">instanceof</span><span style="color: #E1E4E8;"> $this</span><span style="color: #F97583;">-&gt;</span><span style="color: #E1E4E8;">model) {</span></div><div class='line'><span style="color: #E1E4E8;">        $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">fill</span><span style="color: #E1E4E8;">($input);</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> ($model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">save</span><span style="color: #E1E4E8;">()) {</span></div><div class='line'><span style="color: #E1E4E8;">            </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> $model;</span></div><div class='line'><span style="color: #E1E4E8;">        }</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">null</span><span style="color: #E1E4E8;">;</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>This is a recent addition to my base repository, but I find it very useful. One of things I always do with my Eloquent models, is make sure the <code>$fillable</code> array is correctly configured. I know that the processing of my model data has happened outside of the repository (because it's not the repositories job), so I can pass an array to the method, to persist the data to the database. If I was performing a create action, the second argument would be null, and if it was an update, I'd pass in the model (or the id).</p>
<p>This isn't strictly needed, but it's helpful. It has made partial updates simpler, and has stopped me having to write specific create and/or update methods.</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">public</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">delete</span><span style="color: #E1E4E8;">($model)</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">?bool</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> ($model </span><span style="color: #F97583;">instanceof</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">Model</span><span style="color: #E1E4E8;">) {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">delete</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    $id    </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> $model;</span></div><div class='line'><span style="color: #E1E4E8;">    $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">make</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">newQuery</span><span style="color: #E1E4E8;">()</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">where</span><span style="color: #E1E4E8;">($model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">getKeyName</span><span style="color: #E1E4E8;">(), $id)</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">delete</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>For every 10 repositories I write, I probably need 1, maybe 2 custom delete methods. For the rest, I just use this inherited method. Simple and tidy.</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">public</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">getBy</span><span style="color: #E1E4E8;">()</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">?</span><span style="color: #79B8FF;">Collection</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">query</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\func_num_args</span><span style="color: #E1E4E8;">() </span><span style="color: #F97583;">===</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">2</span><span style="color: #E1E4E8;">) {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #79B8FF;">list</span><span style="color: #E1E4E8;">($column, $value) </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\func_get_args</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">        $method </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\is_array</span><span style="color: #E1E4E8;">($value) </span><span style="color: #F97583;">?</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;whereIn&#39;</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;where&#39;</span><span style="color: #E1E4E8;">;</span></div><div class='line'><span style="color: #E1E4E8;">        $model  </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #E1E4E8;">$method($column, $value);</span></div><div class='line'><span style="color: #E1E4E8;">    } </span><span style="color: #F97583;">elseif</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\func_num_args</span><span style="color: #E1E4E8;">() </span><span style="color: #F97583;">===</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">1</span><span style="color: #E1E4E8;">) {</span></div><div class='line'><span style="color: #E1E4E8;">        $columns </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">func_get_arg</span><span style="color: #E1E4E8;">(</span><span style="color: #79B8FF;">0</span><span style="color: #E1E4E8;">);</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\is_array</span><span style="color: #E1E4E8;">($columns)) {</span></div><div class='line'><span style="color: #E1E4E8;">            </span><span style="color: #F97583;">foreach</span><span style="color: #E1E4E8;"> ($columns </span><span style="color: #F97583;">as</span><span style="color: #E1E4E8;"> $column </span><span style="color: #F97583;">=&gt;</span><span style="color: #E1E4E8;"> $value) {</span></div><div class='line'><span style="color: #E1E4E8;">                $method </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\is_array</span><span style="color: #E1E4E8;">($value) </span><span style="color: #F97583;">?</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;whereIn&#39;</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;where&#39;</span><span style="color: #E1E4E8;">;</span></div><div class='line'><span style="color: #E1E4E8;">                $model  </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #E1E4E8;">$method($column, $value);</span></div><div class='line'><span style="color: #E1E4E8;">            }</span></div><div class='line'><span style="color: #E1E4E8;">        }</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">get</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>This method is a super useful helper function that lets me retrieve multiple rows by basic column =&gt; value conditions. For example, I can do the following;</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #E1E4E8;">$inactive </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> $repository</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">getBy</span><span style="color: #E1E4E8;">([</span><span style="color: #9ECBFF;">&#39;active&#39;</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">=&gt;</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">0</span><span style="color: #E1E4E8;">]);</span></div></code></pre>
<p>This method is actually accompanied by two others;</p>
<pre><code data-theme="github-dark" data-lang="php" class='torchlight' style='background-color: #24292e; --theme-selection-background: #39414a;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F97583;">public</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">getOneBy</span><span style="color: #E1E4E8;">()</span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">?</span><span style="color: #79B8FF;">Model</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    $model </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">query</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\func_num_args</span><span style="color: #E1E4E8;">() </span><span style="color: #F97583;">===</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">2</span><span style="color: #E1E4E8;">) {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #79B8FF;">list</span><span style="color: #E1E4E8;">($column, $value) </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\func_get_args</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">        $method </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\is_array</span><span style="color: #E1E4E8;">($value) </span><span style="color: #F97583;">?</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;whereIn&#39;</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;where&#39;</span><span style="color: #E1E4E8;">;</span></div><div class='line'><span style="color: #E1E4E8;">        $model  </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #E1E4E8;">$method($column, $value);</span></div><div class='line'><span style="color: #E1E4E8;">    } </span><span style="color: #F97583;">elseif</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\func_num_args</span><span style="color: #E1E4E8;">() </span><span style="color: #F97583;">===</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">1</span><span style="color: #E1E4E8;">) {</span></div><div class='line'><span style="color: #E1E4E8;">        $columns </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\func_get_args</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\is_array</span><span style="color: #E1E4E8;">($columns)) {</span></div><div class='line'><span style="color: #E1E4E8;">            </span><span style="color: #F97583;">foreach</span><span style="color: #E1E4E8;"> ($columns </span><span style="color: #F97583;">as</span><span style="color: #E1E4E8;"> $column </span><span style="color: #F97583;">=&gt;</span><span style="color: #E1E4E8;"> $value) {</span></div><div class='line'><span style="color: #E1E4E8;">                $method </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\is_array</span><span style="color: #E1E4E8;">($value) </span><span style="color: #F97583;">?</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;whereIn&#39;</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">:</span><span style="color: #E1E4E8;"> </span><span style="color: #9ECBFF;">&#39;where&#39;</span><span style="color: #E1E4E8;">;</span></div><div class='line'><span style="color: #E1E4E8;">                $model  </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #E1E4E8;">$method($column, $value);</span></div><div class='line'><span style="color: #E1E4E8;">            }</span></div><div class='line'><span style="color: #E1E4E8;">        }</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> $model</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">first</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #F97583;">public</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">function</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">__call</span><span style="color: #E1E4E8;">(</span><span style="color: #F97583;">string</span><span style="color: #E1E4E8;"> $name, </span><span style="color: #F97583;">array</span><span style="color: #E1E4E8;"> $arguments </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> [])</span></div><div class='line'><span style="color: #E1E4E8;">{</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">\count</span><span style="color: #E1E4E8;">($arguments) </span><span style="color: #F97583;">&gt;</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">1</span><span style="color: #E1E4E8;">) {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #6A737D;">// TODO: Should probably throw an exception here</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">null</span><span style="color: #E1E4E8;">;</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">0</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">===</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">strpos</span><span style="color: #E1E4E8;">($name, </span><span style="color: #9ECBFF;">&#39;getBy&#39;</span><span style="color: #E1E4E8;">)) {</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">getBy</span><span style="color: #E1E4E8;">(</span><span style="color: #B392F0;">snake_case</span><span style="color: #E1E4E8;">(</span><span style="color: #79B8FF;">substr</span><span style="color: #E1E4E8;">($name, </span><span style="color: #79B8FF;">5</span><span style="color: #E1E4E8;">)), $arguments[</span><span style="color: #79B8FF;">0</span><span style="color: #E1E4E8;">]);</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">    </span><span style="color: #F97583;">if</span><span style="color: #E1E4E8;"> (</span><span style="color: #79B8FF;">0</span><span style="color: #E1E4E8;"> </span><span style="color: #F97583;">===</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">strpos</span><span style="color: #E1E4E8;">($name, </span><span style="color: #9ECBFF;">&#39;getOneBy&#39;</span><span style="color: #E1E4E8;">)) {</span></div><div class='line'><span style="color: #E1E4E8;">        $column </span><span style="color: #F97583;">=</span><span style="color: #E1E4E8;"> </span><span style="color: #B392F0;">snake_case</span><span style="color: #E1E4E8;">(</span><span style="color: #79B8FF;">substr</span><span style="color: #E1E4E8;">($name, </span><span style="color: #79B8FF;">8</span><span style="color: #E1E4E8;">));</span></div><div class='line'><span style="color: #E1E4E8;">        </span><span style="color: #F97583;">return</span><span style="color: #E1E4E8;"> </span><span style="color: #79B8FF;">\call_user_func</span><span style="color: #E1E4E8;">([</span><span style="color: #79B8FF;">$this</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">make</span><span style="color: #E1E4E8;">(), </span><span style="color: #9ECBFF;">&#39;where&#39;</span><span style="color: #E1E4E8;">], $column, $arguments[</span><span style="color: #79B8FF;">0</span><span style="color: #E1E4E8;">])</span><span style="color: #F97583;">-&gt;</span><span style="color: #B392F0;">first</span><span style="color: #E1E4E8;">();</span></div><div class='line'><span style="color: #E1E4E8;">    }</span></div><div class='line'><span style="color: #E1E4E8;">}</span></div></code></pre>
<p>The <code>getOneBy</code> method is the sister of the <code>getBy</code>, essentially performing a <code>first()</code> on the query, rather than a <code>get()</code>.</p>
<p>The <code>__call</code> method allows you to do things like <code>getByActive(0)</code>, <code>getOneById(1)</code> and so on and so forth. The magic method mapping only allows for one condition. As I write this, I also realise that the <code>getOneBy</code> and <code>getBy</code> can abstracted out, as there's some duplicate code there.</p>
<h3><a id="conclusion" href="#conclusion" class="hidden" aria-hidden="true" title="Permalink"></a>Conclusion</h3>
<p>Either using a base repository that's already available, or creating yourself one, can simplify the process of using a repository. There's no need to complicate everything with as many interfaces as there are repositories.</p>
<p>I hope this has helped those of you there were on the fence or unsure. If you have any further questions, feel free to leave a comment.</p>
    </main>
</div>
</main>

    <!-- Fathom - beautiful, simple website analytics -->
    <script src="https://cdn.usefathom.com/script.js" data-site="THPWLTOW" defer></script>
    <!-- / Fathom -->

<script src="/assets/build/js/main.js?id=332d80b6520e8206b9564927e5f9bd73"></script>


</body>
</html>
